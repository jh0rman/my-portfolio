<button id="themeToggler" class="theme-toggle shadow b:mimosa/.2 bb:1 bg:mimosa/.2 bg:mimosa/.3:hover bg:casper/.1@dark bg:casper/.2:hover@dark border:casper/.1@dark f:mimosa f:casper@dark h:48 p:12 r:16 w:48" type="button" title="Toggle theme" aria-label="Toggle theme">
  <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-hidden="true" class="theme-toggle__simple" viewBox="0 0 32 32">
    <clipPath id="a">
      <path d="M0-5h55v37H0zM32 7a1 1 0 0 0 25 0 1 1 0 0 0-25 0"/>
    </clipPath>
    <g clip-path="url(#a)">
      <circle cx="16" cy="16" r="15"/>
    </g>
  </svg>
</button>

<script>
  const themeToggler = document.getElementById('themeToggler')

  if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
    document.documentElement.classList.add('dark')
    themeToggler?.classList.add('theme-toggle--toggled')
  } else {
    document.documentElement.classList.remove('dark')
  }

  themeToggler?.addEventListener('click', toggleTheme)

  function toggleTheme () {
    const isDarkMode = document.documentElement.classList.contains('dark')

    if (isDarkMode) {
      document.documentElement.classList.remove('dark')
      localStorage.setItem('theme', 'light')
    } else {
      document.documentElement.classList.add('dark')
      localStorage.setItem('theme', 'dark')
    }
    themeToggler?.classList.toggle('theme-toggle--toggled')
  }
</script>
